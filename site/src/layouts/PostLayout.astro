---
import BaseLayout from './BaseLayout.astro';

const { Content, data } = Astro.props as {
  Content: any;
  data: {
    title: string;
    description: string;
    published: Date;
    updated?: Date;
    tags: string[];
    hero?: string;
  };
};

const title = data?.title ?? 'Untitled Post';
const description = data?.description ?? 'Details coming soon.';
const published = data?.published instanceof Date ? data.published : new Date(0);
const updated = data?.updated instanceof Date ? data.updated : null;
const tags = Array.isArray(data?.tags) ? data.tags : [];
const hero = data?.hero;

const formattedPublished = published.toLocaleDateString(undefined, {
  month: 'short',
  day: 'numeric',
  year: 'numeric',
});

const formattedUpdated = updated
  ? updated.toLocaleDateString(undefined, {
      month: 'short',
      day: 'numeric',
      year: 'numeric',
    })
  : null;
---

<BaseLayout title={title} description={description}>
  <article class="space-y-8">
    <header class="space-y-4">
      <div class="space-y-2">
        <h1 class="text-4xl font-bold text-white md:text-5xl">{title}</h1>
        <p class="max-w-prose text-lg text-text-light/80">{description}</p>
      </div>
      <div class="flex flex-wrap items-center gap-3 text-sm text-text-light/70">
        <time datetime={published.toISOString()}>Published {formattedPublished}</time>
        {formattedUpdated && (
          <span aria-live="polite" class="text-xs uppercase tracking-wide text-text-light/60">
            Updated {formattedUpdated}
          </span>
        )}
        {tags.length > 0 && (
          <ul class="flex flex-wrap gap-2 text-xs uppercase tracking-wide">
            {tags.map((tag) => (
              <li class="rounded-full border border-white/10 px-3 py-1">{tag}</li>
            ))}
          </ul>
        )}
      </div>
    </header>

    {hero && (
      <figure>
        <img
          class="w-full rounded-2xl border border-white/10"
          src={hero}
          alt=""
          role="presentation"
        />
      </figure>
    )}

    <div class="prose prose-invert max-w-none">
      <Content />
    </div>
  </article>
</BaseLayout>
