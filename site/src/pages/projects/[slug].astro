---
import { getEntryBySlug } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import ProjectLayout from '../../layouts/ProjectLayout.astro';
import { projects } from '../../data/projects';
import type { ProjectMeta } from '../../data/projects';

export async function getStaticPaths() {
  return Promise.all(
    projects.map(async (meta) => {
      const entry = await getEntryBySlug('projects', meta.slug);

      return {
        params: { slug: meta.slug },
        props: {
          meta,
          entry,
        },
      };
    })
  );
}

const { meta, entry } = Astro.props as {
  meta: ProjectMeta;
  entry: CollectionEntry<'projects'> | null;
};

let Content: any = null;
if (entry) {
  ({ Content } = await entry.render());
}
---

<ProjectLayout Content={Content} meta={meta} />
