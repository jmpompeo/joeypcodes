---
import BaseLayout from '../layouts/BaseLayout.astro';
import CTAButton from '../components/CTAButton.astro';
import ProjectCard from '../components/ProjectCard.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects'))
  .filter(({ data }) => !data.draft)
  .sort((a, b) => a.data.order - b.data.order)
  .slice(0, 3);

const posts = (await getCollection('posts'))
  .filter(({ data }) => !data.draft)
  .sort((a, b) => b.data.published.getTime() - a.data.published.getTime())
  .slice(0, 3);

const skillPillars = ['.NET', 'Azure Functions', 'CI/CD', 'Bicep', 'Git', 'Unit Testing'];
---

<BaseLayout
  title="C#/.NET engineer building Azure-backed apps."
  description="I design and build scalable, automated solutions in .NET and Azure — with clean code, solid testing, and CI/CD best practices."
>
  <section class="space-y-12">
    <div class="space-y-8">
      <div class="space-y-6">
        <p class="text-xs uppercase tracking-[0.3em] text-primary">Azure-focused engineer</p>
        <h1 class="text-4xl font-bold text-white md:text-5xl">
          C#/.NET engineer building Azure-backed apps.
        </h1>
        <p class="max-w-prose text-lg text-text-light/80">
          I design and build scalable, automated solutions in .NET and Azure — with clean code,
          solid testing, and CI/CD best practices.
        </p>
      </div>
      <div class="flex flex-wrap gap-3 text-xs uppercase tracking-wide text-text-light/70">
        {skillPillars.map((skill) => (
          <span class="rounded-full border border-white/10 bg-surface-dark/70 px-4 py-2">{skill}</span>
        ))}
      </div>
      <div class="flex flex-wrap gap-4">
        <CTAButton href="/assets/Joey-Pompeo-Resume.pdf" download variant="primary">
          Download Résumé
        </CTAButton>
        <CTAButton href="/contact" variant="secondary">
          Hire Me → Contact
        </CTAButton>
      </div>
    </div>

    <section class="space-y-6">
      <div class="flex items-center justify-between gap-4">
        <h2 class="text-2xl font-semibold text-white">Featured Projects</h2>
        <a class="text-sm text-primary underline-offset-4 hover:underline" href="/projects">
          View all projects
        </a>
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        {projects.map((project) => (
          <ProjectCard project={project} />
        ))}
      </div>
    </section>

    <section class="space-y-6">
      <div class="flex items-center justify-between gap-4">
        <h2 class="text-2xl font-semibold text-white">Latest Posts</h2>
        <a class="text-sm text-primary underline-offset-4 hover:underline" href="/blog">
          Read the blog
        </a>
      </div>
      <div class="grid gap-6 md:grid-cols-2">
        {posts.map((post) => (
          <PostCard post={post} />
        ))}
      </div>
    </section>
  </section>
</BaseLayout>
