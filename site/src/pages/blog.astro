---
import BaseLayout from '../layouts/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts'))
  .filter(({ data }) => !data.draft)
  .sort((a, b) => b.data.published.getTime() - a.data.published.getTime());

const tags = Array.from(new Set(posts.flatMap((post) => post.data.tags))).sort((a, b) =>
  a.localeCompare(b)
);
---

<BaseLayout
  title="Technical notes and tutorials"
  description="Exploring Azure automation, .NET engineering, and DevOps delivery through practical guides and case studies."
>
  <section class="space-y-10">
    <header class="space-y-4">
      <p class="text-xs uppercase tracking-[0.3em] text-primary">Blog</p>
      <h1 class="text-4xl font-bold text-white md:text-5xl">Latest writing</h1>
      <p class="max-w-prose text-text-light/80">
        Articles focus on applying Azure, CI/CD, and automation in the real world. Tag filters are a planned enhancement â€”
        for now, browse the topics that interest you most.
      </p>
    </header>

    <div class="flex flex-wrap gap-3">
      {tags.map((tag) => (
        <button
          type="button"
          class="cursor-default rounded-full border border-white/10 bg-surface-dark/70 px-4 py-2 text-xs uppercase tracking-wide text-text-light/70"
          aria-disabled="true"
        >
          {tag}
        </button>
      ))}
    </div>

    <div class="grid gap-6 md:grid-cols-2">
      {posts.map((post) => (
        <PostCard post={post} />
      ))}
    </div>
  </section>
</BaseLayout>
